import axios from "axios";

export const weather = async (sock, m, args) => {
    const city = args.join(" ");
    if (!city) {
        return `â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘    ğŸŒ¤ï¸ *ğ•‹ğ”¼â„ğ•ğ•Œğ• ğ•ğ”¼ğ”¸ğ•‹â„ğ”¼â„* ğŸŒ¤ï¸      â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“ *ğ•Œğ•¤ğ•’ğ•˜ğ•–:* !weather [city]
ğŸ“Œ *ğ”¼ğ•©ğ•’ğ•ğ•¡ğ•ğ•–:* !weather Nairobi

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Get real-time weather updates! ğŸŒ`;
    }

    try {
        const response = await axios.get(`https://wttr.in/${encodeURIComponent(city)}?format=%c+%t+%w+%h`, { timeout: 8000 });
        const data = response.data;

        if (data.includes("Unknown location")) {
            return `â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘         âŒ *ğ”¼â„â„ğ•†â„* âŒ            â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

City not found!
Please check the spelling.`;
        }

        const parts = data.trim().split(" ");
        const icon = parts[0] || "ğŸŒ¡ï¸";
        const temp = parts[1] || "N/A";
        const wind = parts[2] || "N/A";
        const humidity = parts[3] || "N/A";

        return `â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘    ğŸŒ¤ï¸ *ğ•‹ğ”¼â„ğ•ğ•Œğ• ğ•ğ”¼ğ”¸ğ•‹â„ğ”¼â„* ğŸŒ¤ï¸      â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“ *ğ•ƒğ• ğ•”ğ•’ğ•¥ğ•šğ• ğ•Ÿ:* ${city.toUpperCase()}

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸŒ¡ï¸ *â„‚ğ•Œâ„â„ğ”¼â„•ğ•‹ â„‚ğ•†â„•ğ”»ğ•€ğ•‹ğ•€ğ•†â„•ğ•Š*
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

${icon} *Condition:* ${icon}
ğŸŒ¡ï¸ *Temperature:* ${temp}
ğŸ’¨ *Wind:* ${wind}
ğŸ’§ *Humidity:* ${humidity}

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
_Data from wttr.in_ ğŸŒ`;
    } catch (err) {
        console.error("Weather error:", err.message);
        return `â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘         âŒ *ğ”¼â„â„ğ•†â„* âŒ            â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Failed to fetch weather data.
Network busy or timeout.`;
    }
};
